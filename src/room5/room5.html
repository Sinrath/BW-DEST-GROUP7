<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>VR Escape Room - Room 5</title>
    <meta name="description" content="VR Escape Room Room 5 - A-Frame">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">

    <!-- A-Frame -->
    <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>

    <!-- A-Frame Extras (movement controls and collision) -->
    <script src="../../aframe-extras/dist/aframe-extras.js"></script>
    <script src="https://unpkg.com/aframe-look-at-component@1.0.0/dist/aframe-look-at-component.min.js"></script>

    <script src="../shared/movement.js"></script>
    <script src="../shared/components.js"></script>
    <script src="room5.js"></script>

</head>
<body>

<a-scene background="color: #f0f0f0"
         vr-mode-ui="enabled: true">

    <!-- Assets -->
    <a-assets>
        <a-asset-item id="table" src="../../models/office_table.glb"></a-asset-item>
        <a-asset-item id="keyModel" src="../../models/key.glb"></a-asset-item>
        <a-asset-item id="lockedDoorModel" src="../../models/door_with_frame.glb"></a-asset-item>
    </a-assets>

    <!-- Lighting -->
    <a-light type="ambient" color="#ffffff" intensity="0.9"></a-light>
    <a-light type="directional" position="2 4 2" color="#ffffff" intensity="1.3"></a-light>
    <a-light type="point" position="0 3 0" color="#ffffff" intensity="1.5" distance="20"></a-light>
    <a-light type="point" position="5 2 5" color="#ffffff" intensity="0.8" distance="15"></a-light>
    <a-light type="point" position="-5 2 -5" color="#ffffff" intensity="0.8" distance="15"></a-light>

    <!-- Room 5 Structure (16x16) -->
    <a-box position="0 -0.05 0" width="16" height="0.1" depth="16"
           material="color: #e0e0e0; roughness: 0.3"></a-box>
    <a-box position="0 3.05 0" width="16" height="0.1" depth="16"
           material="color: #f5f5f5; roughness: 0.2"></a-box>

    <!-- Room 5 Walls -->
    <a-box position="0 1.5 -8" width="16" height="3" depth="0.3"
           material="color: #d0d0d0; roughness: 0.4"></a-box>
    <a-box position="-6 1.5 8" width="4" height="3" depth="0.3"
           material="color: #d0d0d0; roughness: 0.4"></a-box>
    <a-box position="6 1.5 8" width="4" height="3" depth="0.3"
           material="color: #d0d0d0; roughness: 0.4"></a-box>
    <a-box position="-8 1.5 0" width="0.3" height="3" depth="16"
           material="color: #d0d0d0; roughness: 0.4"></a-box>
    <a-box position="8 1.5 0" width="0.3" height="3" depth="16"
           material="color: #d0d0d0; roughness: 0.4"></a-box>

    <!-- Wall (replaced doors) -->
    <a-box position="0 1.5 8" width="8" height="3" depth="0.3"
           material="color: #d0d0d0; roughness: 0.4"></a-box>

    <!-- Room Title -->
    <a-text position="0 2.5 -7" value="RAUM 5" align="center"
            color="black" scale="1.2 1.2 1.2"></a-text>

    <!-- Table -->
    <a-entity gltf-model="#table" position="0 1 0" rotation="0 0 0"
              scale="0.06 0.02 0.02">
    </a-entity>

    <!-- Sorting spots on table (gray until both materials placed) -->
    <a-cylinder id="spot1" position="-0.8 1.05 1" radius="0.4" height="0.05"
                material="color: gray; opacity: 0.6"
                class="sorting-spot"
                data-correct-material="hanfbeton"></a-cylinder>
    <a-cylinder id="spot2" position="0.8 1.05 1" radius="0.4" height="0.05"
                material="color: gray; opacity: 0.6"
                class="sorting-spot"
                data-correct-material="holz"></a-cylinder>

    <!-- Labels for spots -->
    <a-text position="-0.8 1.3 1" value="Most Sustainable" align="center"
            color="black" scale="0.4 0.4 0.4"></a-text>
    <a-text position="0.8 1.3 1" value="Less Sustainable" align="center"
            color="black" scale="0.4 0.4 0.4"></a-text>


    <!-- Material 1: Hanfbeton (Hemp Concrete) - Most sustainable -->
    <a-box id="material-hanfbeton" position="-3 0.25 3" width="0.5" height="0.5" depth="0.5"
           material="color: #A0522D"
           class="material pickupable"
           data-material="hanfbeton"></a-box>
    <a-text position="-3 0.8 3" value="Hanfbeton" align="center"
            color="black" scale="0.4 0.4 0.4"></a-text>

    <!-- Material 2: Holz (Wood) - Less sustainable -->
    <a-box id="material-holz" position="3 0.25 3" width="0.5" height="0.5" depth="0.5"
           material="color: #8B4513"
           class="material pickupable"
           data-material="holz"></a-box>
    <a-text position="3 0.8 3" value="Holz" align="center"
            color="black" scale="0.4 0.4 0.4"></a-text>

    <!-- Locked Door (initially visible, but not interactive) -->
    <a-gltf-model id="locked-door" src="#lockedDoorModel"
                  position="0 0 -7.5"
                  scale="0.02 0.02 0.02"
                  rotation="0 0 0"
                  autocenter-gltf="ground: true"></a-gltf-model>
    <a-text position="0 2 -7" value="ðŸ”’ LOCKED DOOR" align="center"
            color="red" scale="0.6 0.6 0.6"></a-text>
    <a-text position="0 1.5 -7" value="Find the key!" align="center"
            color="orange" scale="0.4 0.4 0.4"></a-text>

    <!-- Key (hidden initially, drops when puzzle solved) -->
    <a-gltf-model id="key" src="#keyModel"
                  position="0 4 1"
                  scale="0.001 0.001 0.001"
                  rotation="0 0 0"
                  class="key pickupable"
                  data-item="key"
                  visible="false"
                  autocenter-gltf="ground: false"></a-gltf-model>

    <a-entity id="leftHand"
              hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"></a-entity>
    <a-entity id="rightHand"
              hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc"></a-entity>

    <a-entity id="rig"
              position="0 1.6 5"
              movement-controls="controls: keyboard, touch"
              simple-collision>
        <a-entity id="playerCam" camera look-controls>
            <a-cursor position="0 0 -1"
                      geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                      material="color: white; shader: flat"
                      raycaster="objects: .door, .material, .key, .sorting-spot, .placed-material; showLine: true"></a-cursor>
        </a-entity>

    <!-- UI Text -->
    <a-text id="message" position="0 2.8 2"
            value="Sort materials by sustainability on the table! Click materials to pick up and drop on correct spots."
            align="center" color="black" scale="0.5 0.5 0.5" look-at="#playerCam"></a-text>
</a-scene>
</body>
</html>
